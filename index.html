<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <link rel="stylesheet" href="style.css">
    <title>Firebase</title>
</head>

<body>

	
	<main>


		<h1>TodoList</h1>
		<div class="form">
		<label for="Roolbox">Id</label>
		<input id="Rollbox">
		<label for="Namebox">Nom Tache</label>
		<input id="NameBox">
		<label for="Secbox">Description</label>
		<input id="Secbox">

	

		<button id="Insbtn" class="btn waves-effect waves-light">Insertion</button>
		<button id="Selbtn" class="btn waves-effect waves-light">Selection</button>
		<button id="Updbtn" class="btn waves-effect waves-light">Update</button>
		<button id="Delbtn" class="btn waves-effect waves-light">Delete</button>
	
        </div >
			<div id="list"></div>
	</main>
</body>

<!--+++++++++++++   Importation et la configuration de firebase   +++++++++++++++++-->

<script type="module" defer>
	import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.0/firebase-app.js";
	import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.6.0/firebase-analytics.js";




	const firebaseConfig = {
		apiKey: "AIzaSyDAIa6apUHYoreT7VMM5sMabKonNkbZ6rY",
		authDomain: "apptodo-9a6b9.firebaseapp.com",
		projectId: "apptodo-9a6b9",
		storageBucket: "apptodo-9a6b9.appspot.com",
		messagingSenderId: "249228070502",
		appId: "1:249228070502:web:7ed59b9f5998bf1240e7a7"
	};

	const app = initializeApp(firebaseConfig);
	const analytics = getAnalytics(app);

	import { getDatabase, ref, set, get, child, update, remove }

		from "https://www.gstatic.com/firebasejs/9.6.0/firebase-database.js";

	var db = getDatabase();


	//-------------------reference -----------------------------

	var namebox = document.getElementById("NameBox");
	var rollbox = document.getElementById("Rollbox");
	var secbox = document.getElementById("Secbox");
	


	var insbtn = document.getElementById("Insbtn");
	var selbtn = document.getElementById("Selbtn");
	var updbtn = document.getElementById("Updbtn");
	var delbtn = document.getElementById("Delbtn");

	//-------------  La fonction insert DATA--------------------


	function InserData() {
		set(ref(db, "Users/" + rollbox.value), {
			NameOfStd: namebox.value,
			RollNo: rollbox.value,
			section: secbox.value,
			
		})

			.then(() => {
				alert('Les donnees ont bien ete envoyé');
			})

			.catch((error) => {
				alert("Le message na pas ete envoyé");
			});
	}

	//-------------  envoie des donnes ------------------------

	insbtn.addEventListener('click', InserData);

	selbtn.addEventListener('click', SelectData);

	updbtn.addEventListener('click', UpdateData);

	delbtn.addEventListener('click', removeData);



	//-------------Selection des donnes --------------------------
	function SelectData() {
		const dbref = ref(db);

		get(child(dbref, "Users/" + rollbox.value)).then((snapshot) => {
			if (snapshot.exists()) {
				namebox.value = snapshot.val().NameOfStd;
				secbox.value = snapshot.val().section;
				
			} else {
				alert("Les donnees ne sont pas disponible");
			}
		});
	}


	//---------------La Lafoction qui npus permet de faire des update --------------------

	function UpdateData() {
		update(ref(db, "Users/" + rollbox.value), {
			NameOfStd: namebox.value,
			section: secbox.value
		})

			.then(() => {
				alert('Les donnees ont bien ete mis a jour');
			})

			.catch((error) => {
				alert("Le message na pas ete envoyé");
			});
	}

	//--------------La fonction qui vous permet va me permettre de faire un---------------------


	function removeData() {
		remove(ref(db, "Users/" + rollbox.value))

			.then(() => {
				alert('Les donnees ont bien ete supprimé');
			})

			.catch((error) => {
				alert("Le message na pas ete envoyé");
			});
	}




</script>

</html>